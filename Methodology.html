
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Methodology &#8212; ACRG Emissions by sector</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Annual emissions broken down by sector" href="Main_Page1.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/uob_logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">ACRG Emissions by sector</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="Main_Page1.html">
                    Annual emissions broken down by sector
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Methodology
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/docs/Methodology.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/executablebooks/jupyter-book"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FMethodology.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/Methodology.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Methodology</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="methodology">
<h1>Methodology<a class="headerlink" href="#methodology" title="Permalink to this heading">#</a></h1>
<p>This section will discuss the methodology surrounding the 2012-2015 data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">takewhile</span>
<span class="kn">import</span> <span class="nn">plotly.graph_objects</span> <span class="k">as</span> <span class="nn">go</span>
<span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>
<span class="kn">import</span> <span class="nn">base64</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">loadtxt</span>

<span class="kn">import</span> <span class="nn">cartopy</span>
<span class="kn">import</span> <span class="nn">cartopy.crs</span> <span class="k">as</span> <span class="nn">ccrs</span>
<span class="kn">from</span> <span class="nn">cartopy.mpl.ticker</span> <span class="kn">import</span> <span class="n">LongitudeFormatter</span><span class="p">,</span> <span class="n">LatitudeFormatter</span>

<span class="kn">from</span> <span class="nn">fig_mods.nextstep</span> <span class="kn">import</span> <span class="n">areagrid</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds_flux_old</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s2">&quot;data/flux_data.nc&quot;</span><span class="p">)</span>

<span class="c1">## Set the longitude and latitude to only include the UK;</span>

<span class="n">min_lon</span> <span class="o">=</span> <span class="o">-</span><span class="mi">12</span>
<span class="n">min_lat</span> <span class="o">=</span> <span class="mi">48</span>
<span class="n">max_lon</span> <span class="o">=</span> <span class="mi">5</span> 
<span class="n">max_lat</span> <span class="o">=</span> <span class="mi">62</span> 

<span class="n">ds_flux_old</span> <span class="o">=</span> <span class="n">ds_flux_old</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">min_lat</span><span class="p">,</span><span class="n">max_lat</span><span class="p">),</span> <span class="n">lon</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">min_lon</span><span class="p">,</span><span class="n">max_lon</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds_flux</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s2">&quot;data/flux_MetOffice-InTEM_ch4_MHD_TAC_RGL_TTA_BSD_HFD_CBW_WAO_JFJ_CMN_ZEP_TRN_LUT_2012-2021_Dec2022.nc&quot;</span><span class="p">)</span>

<span class="c1">## Set the longitude and latitude to only include the UK;</span>

<span class="n">min_lon</span> <span class="o">=</span> <span class="o">-</span><span class="mi">12</span>
<span class="n">min_lat</span> <span class="o">=</span> <span class="mi">50</span>

<span class="n">max_lon</span> <span class="o">=</span> <span class="mi">2</span> 
<span class="n">max_lat</span> <span class="o">=</span> <span class="mi">62</span> 

<span class="n">ds_flux</span> <span class="o">=</span> <span class="n">ds_flux</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">min_lat</span><span class="p">,</span><span class="n">max_lat</span><span class="p">),</span> <span class="n">lon</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">min_lon</span><span class="p">,</span><span class="n">max_lon</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds_flux</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:             (time: 120, lon: 39, lat: 52, country: 1)
Coordinates:
  * time                (time) datetime64[ns] 2012-01-01 ... 2021-12-01
  * lon                 (lon) float32 -11.66 -11.31 -10.96 ... 1.012 1.364 1.716
  * lat                 (lat) float32 50.04 50.28 50.51 ... 61.51 61.74 61.98
Dimensions without coordinates: country
Data variables:
    country_name        (country) |S2 b&#x27;UK&#x27;
    flux_mean           (lat, lon, time) float32 ...
    flux_std            (lat, lon, time) float32 ...
    flux_prior          (lat, lon, time) float32 ...
    flux_std_prior      (lat, lon, time) float32 ...
    country_post_mean   (country, time) float32 2.168 2.572 ... 2.054 2.127
    country_post_std    (country, time) float32 0.7221 0.7403 ... 0.498 0.4932
    country_prior_mean  (country, time) float32 2.061 2.061 ... 1.986 1.986
    country_prior_std   (country, time) float32 0.8509 0.8509 ... 0.8049 0.8049
Attributes:
    history:           Created on 2022-12-06 08:38:46 by A. J. Manning
    molecular_weight:  16.0</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-4d96ce1e-b49a-4973-b878-c874bb5ff5c0' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-4d96ce1e-b49a-4973-b878-c874bb5ff5c0' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 120</li><li><span class='xr-has-index'>lon</span>: 39</li><li><span class='xr-has-index'>lat</span>: 52</li><li><span>country</span>: 1</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-52922055-b51d-4310-9628-3698b1efed32' class='xr-section-summary-in' type='checkbox'  checked><label for='section-52922055-b51d-4310-9628-3698b1efed32' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2012-01-01 ... 2021-12-01</div><input id='attrs-888f891d-312a-411a-999d-dbd0a1625851' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-888f891d-312a-411a-999d-dbd0a1625851' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7441f5e3-d1d8-446b-a6da-64879ee62f6f' class='xr-var-data-in' type='checkbox'><label for='data-7441f5e3-d1d8-446b-a6da-64879ee62f6f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>time at start of time period</dd><dt><span>standard_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2012-01-01T00:00:00.000000000&#x27;, &#x27;2012-02-01T00:00:00.000000000&#x27;,
       &#x27;2012-03-01T00:00:00.000000000&#x27;, &#x27;2012-04-01T00:00:00.000000000&#x27;,
       &#x27;2012-05-01T00:00:00.000000000&#x27;, &#x27;2012-06-01T00:00:00.000000000&#x27;,
       &#x27;2012-07-01T00:00:00.000000000&#x27;, &#x27;2012-08-01T00:00:00.000000000&#x27;,
       &#x27;2012-09-01T00:00:00.000000000&#x27;, &#x27;2012-10-01T00:00:00.000000000&#x27;,
       &#x27;2012-11-01T00:00:00.000000000&#x27;, &#x27;2012-12-01T00:00:00.000000000&#x27;,
       &#x27;2013-01-01T00:00:00.000000000&#x27;, &#x27;2013-02-01T00:00:00.000000000&#x27;,
       &#x27;2013-03-01T00:00:00.000000000&#x27;, &#x27;2013-04-01T00:00:00.000000000&#x27;,
       &#x27;2013-05-01T00:00:00.000000000&#x27;, &#x27;2013-06-01T00:00:00.000000000&#x27;,
       &#x27;2013-07-01T00:00:00.000000000&#x27;, &#x27;2013-08-01T00:00:00.000000000&#x27;,
       &#x27;2013-09-01T00:00:00.000000000&#x27;, &#x27;2013-10-01T00:00:00.000000000&#x27;,
       &#x27;2013-11-01T00:00:00.000000000&#x27;, &#x27;2013-12-01T00:00:00.000000000&#x27;,
       &#x27;2014-01-01T00:00:00.000000000&#x27;, &#x27;2014-02-01T00:00:00.000000000&#x27;,
       &#x27;2014-03-01T00:00:00.000000000&#x27;, &#x27;2014-04-01T00:00:00.000000000&#x27;,
       &#x27;2014-05-01T00:00:00.000000000&#x27;, &#x27;2014-06-01T00:00:00.000000000&#x27;,
       &#x27;2014-07-01T00:00:00.000000000&#x27;, &#x27;2014-08-01T00:00:00.000000000&#x27;,
       &#x27;2014-09-01T00:00:00.000000000&#x27;, &#x27;2014-10-01T00:00:00.000000000&#x27;,
       &#x27;2014-11-01T00:00:00.000000000&#x27;, &#x27;2014-12-01T00:00:00.000000000&#x27;,
       &#x27;2015-01-01T00:00:00.000000000&#x27;, &#x27;2015-02-01T00:00:00.000000000&#x27;,
       &#x27;2015-03-01T00:00:00.000000000&#x27;, &#x27;2015-04-01T00:00:00.000000000&#x27;,
       &#x27;2015-05-01T00:00:00.000000000&#x27;, &#x27;2015-06-01T00:00:00.000000000&#x27;,
       &#x27;2015-07-01T00:00:00.000000000&#x27;, &#x27;2015-08-01T00:00:00.000000000&#x27;,
       &#x27;2015-09-01T00:00:00.000000000&#x27;, &#x27;2015-10-01T00:00:00.000000000&#x27;,
       &#x27;2015-11-01T00:00:00.000000000&#x27;, &#x27;2015-12-01T00:00:00.000000000&#x27;,
       &#x27;2016-01-01T00:00:00.000000000&#x27;, &#x27;2016-02-01T00:00:00.000000000&#x27;,
       &#x27;2016-03-01T00:00:00.000000000&#x27;, &#x27;2016-04-01T00:00:00.000000000&#x27;,
       &#x27;2016-05-01T00:00:00.000000000&#x27;, &#x27;2016-06-01T00:00:00.000000000&#x27;,
       &#x27;2016-07-01T00:00:00.000000000&#x27;, &#x27;2016-08-01T00:00:00.000000000&#x27;,
       &#x27;2016-09-01T00:00:00.000000000&#x27;, &#x27;2016-10-01T00:00:00.000000000&#x27;,
       &#x27;2016-11-01T00:00:00.000000000&#x27;, &#x27;2016-12-01T00:00:00.000000000&#x27;,
       &#x27;2017-01-01T00:00:00.000000000&#x27;, &#x27;2017-02-01T00:00:00.000000000&#x27;,
       &#x27;2017-03-01T00:00:00.000000000&#x27;, &#x27;2017-04-01T00:00:00.000000000&#x27;,
       &#x27;2017-05-01T00:00:00.000000000&#x27;, &#x27;2017-06-01T00:00:00.000000000&#x27;,
       &#x27;2017-07-01T00:00:00.000000000&#x27;, &#x27;2017-08-01T00:00:00.000000000&#x27;,
       &#x27;2017-09-01T00:00:00.000000000&#x27;, &#x27;2017-10-01T00:00:00.000000000&#x27;,
       &#x27;2017-11-01T00:00:00.000000000&#x27;, &#x27;2017-12-01T00:00:00.000000000&#x27;,
       &#x27;2018-01-01T00:00:00.000000000&#x27;, &#x27;2018-02-01T00:00:00.000000000&#x27;,
       &#x27;2018-03-01T00:00:00.000000000&#x27;, &#x27;2018-04-01T00:00:00.000000000&#x27;,
       &#x27;2018-05-01T00:00:00.000000000&#x27;, &#x27;2018-06-01T00:00:00.000000000&#x27;,
       &#x27;2018-07-01T00:00:00.000000000&#x27;, &#x27;2018-08-01T00:00:00.000000000&#x27;,
       &#x27;2018-09-01T00:00:00.000000000&#x27;, &#x27;2018-10-01T00:00:00.000000000&#x27;,
       &#x27;2018-11-01T00:00:00.000000000&#x27;, &#x27;2018-12-01T00:00:00.000000000&#x27;,
       &#x27;2019-01-01T00:00:00.000000000&#x27;, &#x27;2019-02-01T00:00:00.000000000&#x27;,
       &#x27;2019-03-01T00:00:00.000000000&#x27;, &#x27;2019-04-01T00:00:00.000000000&#x27;,
       &#x27;2019-05-01T00:00:00.000000000&#x27;, &#x27;2019-06-01T00:00:00.000000000&#x27;,
       &#x27;2019-07-01T00:00:00.000000000&#x27;, &#x27;2019-08-01T00:00:00.000000000&#x27;,
       &#x27;2019-09-01T00:00:00.000000000&#x27;, &#x27;2019-10-01T00:00:00.000000000&#x27;,
       &#x27;2019-11-01T00:00:00.000000000&#x27;, &#x27;2019-12-01T00:00:00.000000000&#x27;,
       &#x27;2020-01-01T00:00:00.000000000&#x27;, &#x27;2020-02-01T00:00:00.000000000&#x27;,
       &#x27;2020-03-01T00:00:00.000000000&#x27;, &#x27;2020-04-01T00:00:00.000000000&#x27;,
       &#x27;2020-05-01T00:00:00.000000000&#x27;, &#x27;2020-06-01T00:00:00.000000000&#x27;,
       &#x27;2020-07-01T00:00:00.000000000&#x27;, &#x27;2020-08-01T00:00:00.000000000&#x27;,
       &#x27;2020-09-01T00:00:00.000000000&#x27;, &#x27;2020-10-01T00:00:00.000000000&#x27;,
       &#x27;2020-11-01T00:00:00.000000000&#x27;, &#x27;2020-12-01T00:00:00.000000000&#x27;,
       &#x27;2021-01-01T00:00:00.000000000&#x27;, &#x27;2021-02-01T00:00:00.000000000&#x27;,
       &#x27;2021-03-01T00:00:00.000000000&#x27;, &#x27;2021-04-01T00:00:00.000000000&#x27;,
       &#x27;2021-05-01T00:00:00.000000000&#x27;, &#x27;2021-06-01T00:00:00.000000000&#x27;,
       &#x27;2021-07-01T00:00:00.000000000&#x27;, &#x27;2021-08-01T00:00:00.000000000&#x27;,
       &#x27;2021-09-01T00:00:00.000000000&#x27;, &#x27;2021-10-01T00:00:00.000000000&#x27;,
       &#x27;2021-11-01T00:00:00.000000000&#x27;, &#x27;2021-12-01T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-11.66 -11.31 ... 1.364 1.716</div><input id='attrs-4330e9de-d98a-4ee3-aee1-cf5b0f41a08c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-4330e9de-d98a-4ee3-aee1-cf5b0f41a08c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ee5de518-848a-456e-a22e-c854bef76774' class='xr-var-data-in' type='checkbox'><label for='data-ee5de518-848a-456e-a22e-c854bef76774' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>Degrees east (centre of grid)</dd></dl></div><div class='xr-var-data'><pre>array([-11.66    , -11.308001, -10.956   , -10.604   , -10.252001,  -9.9     ,
        -9.548   ,  -9.196   ,  -8.844   ,  -8.492001,  -8.139999,  -7.788   ,
        -7.436   ,  -7.084   ,  -6.732   ,  -6.38    ,  -6.028001,  -5.676001,
        -5.324   ,  -4.972   ,  -4.620001,  -4.268001,  -3.916   ,  -3.564001,
        -3.212001,  -2.860001,  -2.508   ,  -2.156   ,  -1.804001,  -1.452001,
        -1.1     ,  -0.748001,  -0.396001,  -0.044001,   0.308   ,   0.66    ,
         1.011999,   1.363999,   1.716001], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>50.04 50.28 50.51 ... 61.74 61.98</div><input id='attrs-9880b7c8-b5cd-41b3-91f3-7685b6b149f3' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-9880b7c8-b5cd-41b3-91f3-7685b6b149f3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d9c328a2-d08e-4062-8f40-a00b8d0dd145' class='xr-var-data-in' type='checkbox'><label for='data-d9c328a2-d08e-4062-8f40-a00b8d0dd145' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>Degrees north (centre of grid)</dd></dl></div><div class='xr-var-data'><pre>array([50.041   , 50.275   , 50.509003, 50.743   , 50.977   , 51.211   ,
       51.445   , 51.679   , 51.913002, 52.147   , 52.381   , 52.615   ,
       52.849   , 53.083   , 53.317   , 53.551003, 53.785004, 54.019   ,
       54.253002, 54.487   , 54.721   , 54.955   , 55.189003, 55.423004,
       55.657   , 55.891   , 56.125   , 56.359   , 56.593002, 56.827003,
       57.061   , 57.295002, 57.529   , 57.763   , 57.997   , 58.231003,
       58.465004, 58.699   , 58.933002, 59.167   , 59.401   , 59.635002,
       59.869003, 60.103   , 60.337   , 60.571   , 60.805   , 61.039   ,
       61.273003, 61.507004, 61.741   , 61.975002], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-d3613f8c-6d26-4fef-80de-e6a3aaacdbef' class='xr-section-summary-in' type='checkbox'  checked><label for='section-d3613f8c-6d26-4fef-80de-e6a3aaacdbef' class='xr-section-summary' >Data variables: <span>(9)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>country_name</span></div><div class='xr-var-dims'>(country)</div><div class='xr-var-dtype'>|S2</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-ee3cc7a4-8699-4c82-88c4-91a78eae5578' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-ee3cc7a4-8699-4c82-88c4-91a78eae5578' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2f3c4d3e-9d4a-46cb-91aa-820a9c408040' class='xr-var-data-in' type='checkbox'><label for='data-2f3c4d3e-9d4a-46cb-91aa-820a9c408040' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Name of Region or Country</dd></dl></div><div class='xr-var-data'><pre>array([b&#x27;UK&#x27;], dtype=&#x27;|S2&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>flux_mean</span></div><div class='xr-var-dims'>(lat, lon, time)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-6a224c99-6f18-47e9-9e85-05feefc70350' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-6a224c99-6f18-47e9-9e85-05feefc70350' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c6d0cc50-2e7c-43d5-ab1e-8c7e714ee81a' class='xr-var-data-in' type='checkbox'><label for='data-c6d0cc50-2e7c-43d5-ab1e-8c7e714ee81a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>mol/m2/s</dd><dt><span>long_name :</span></dt><dd>Mean flux from each grid-cell</dd></dl></div><div class='xr-var-data'><pre>[243360 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>flux_std</span></div><div class='xr-var-dims'>(lat, lon, time)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-0236020c-f41e-4d02-bb55-c6586c308c4c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0236020c-f41e-4d02-bb55-c6586c308c4c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d58e7906-d004-4978-92fb-8a9bcb7f7f7a' class='xr-var-data-in' type='checkbox'><label for='data-d58e7906-d004-4978-92fb-8a9bcb7f7f7a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>mol/m2/s</dd><dt><span>long_name :</span></dt><dd>Standard Deviation of flux from each grid-cell</dd></dl></div><div class='xr-var-data'><pre>[243360 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>flux_prior</span></div><div class='xr-var-dims'>(lat, lon, time)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-1c3dbb76-eced-499e-a714-a75b3ea39dda' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-1c3dbb76-eced-499e-a714-a75b3ea39dda' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1524e1cd-d7af-4af2-828c-51aaf0d935bf' class='xr-var-data-in' type='checkbox'><label for='data-1524e1cd-d7af-4af2-828c-51aaf0d935bf' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>mol/m2/s</dd><dt><span>long_name :</span></dt><dd>Prior flux from each grid-cell</dd></dl></div><div class='xr-var-data'><pre>[243360 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>flux_std_prior</span></div><div class='xr-var-dims'>(lat, lon, time)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-a7cc6495-d58e-4c71-9ef7-175c1c3f0994' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a7cc6495-d58e-4c71-9ef7-175c1c3f0994' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6571812b-14f1-43cd-b94e-b7e606060f16' class='xr-var-data-in' type='checkbox'><label for='data-6571812b-14f1-43cd-b94e-b7e606060f16' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>mol/m2/s</dd><dt><span>long_name :</span></dt><dd>Standard Deviation of prior flux from each grid-cell</dd></dl></div><div class='xr-var-data'><pre>[243360 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>country_post_mean</span></div><div class='xr-var-dims'>(country, time)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-6a438629-0f9b-4845-a30c-471472f283da' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-6a438629-0f9b-4845-a30c-471472f283da' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e1f79798-a0bb-4157-863a-c7dcc662f7ec' class='xr-var-data-in' type='checkbox'><label for='data-e1f79798-a0bb-4157-863a-c7dcc662f7ec' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>Tg/yr</dd><dt><span>long_name :</span></dt><dd>Posteriori mean emissions from individual countries</dd></dl></div><div class='xr-var-data'><pre>array([[2.167727, 2.571666, 2.212227, 1.823339, 2.294648, 2.10461 , 2.396338,
        2.167854, 2.425525, 2.293156, 2.516246, 2.747204, 2.239886, 2.596834,
        2.359886, 2.117537, 2.115394, 2.112285, 2.264749, 2.066671, 1.892131,
        1.942683, 2.349188, 2.050642, 2.259673, 2.371988, 2.311097, 2.130244,
        1.967614, 2.166128, 1.902052, 2.139035, 2.381949, 2.059301, 2.28563 ,
        2.442712, 2.231467, 2.450618, 2.333179, 2.276552, 1.953998, 2.047392,
        2.213429, 2.081753, 2.032082, 2.053321, 2.103032, 2.062157, 2.226447,
        2.355891, 2.015151, 2.085951, 2.080161, 2.21382 , 2.106419, 2.128721,
        1.758924, 1.386168, 2.105335, 1.881341, 2.160196, 2.245199, 2.243189,
        1.776064, 1.965327, 2.445762, 1.675009, 1.874464, 2.162891, 2.151055,
        2.08567 , 2.062705, 1.93887 , 1.866717, 2.169725, 1.939908, 2.050732,
        2.127451, 2.253867, 1.803997, 1.950007, 1.718741, 1.897203, 1.925794,
        2.220336, 2.250254, 2.247593, 1.887399, 1.851741, 1.596935, 1.958158,
        1.719308, 1.776441, 1.8696  , 1.89912 , 2.331671, 2.011157, 2.335503,
        2.234219, 1.992753, 2.3161  , 1.709863, 1.873203, 1.681527, 1.842317,
        1.82928 , 1.737506, 2.175472, 2.289111, 2.241425, 2.17252 , 2.106529,
        1.657483, 2.023193, 1.982155, 1.841134, 2.020265, 1.981437, 2.054084,
        2.127383]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>country_post_std</span></div><div class='xr-var-dims'>(country, time)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-586bfada-5612-4d14-accb-c5d6644ca7a3' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-586bfada-5612-4d14-accb-c5d6644ca7a3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fd4f897f-281e-492e-921b-aabd76149cfb' class='xr-var-data-in' type='checkbox'><label for='data-fd4f897f-281e-492e-921b-aabd76149cfb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>Tg/yr</dd><dt><span>long_name :</span></dt><dd>Posteriori standard deviation of emissions from individual countries</dd></dl></div><div class='xr-var-data'><pre>array([[0.722122, 0.740283, 0.605363, 0.534954, 0.545596, 0.487504, 0.54278 ,
        0.516626, 0.523526, 0.504567, 0.538417, 0.523738, 0.602002, 0.638063,
        0.577626, 0.531077, 0.465248, 0.402586, 0.495916, 0.441996, 0.453615,
        0.520061, 0.499783, 0.475372, 0.505337, 0.469235, 0.471937, 0.453685,
        0.404402, 0.36352 , 0.370744, 0.387405, 0.429197, 0.42572 , 0.521764,
        0.457808, 0.458932, 0.438788, 0.461331, 0.354495, 0.329739, 0.366453,
        0.353602, 0.38828 , 0.393845, 0.549532, 0.537088, 0.57242 , 0.506348,
        0.458167, 0.386816, 0.411141, 0.446033, 0.407827, 0.42973 , 0.375769,
        0.470094, 0.457669, 0.471412, 0.594794, 0.527376, 0.570147, 0.48828 ,
        0.417778, 0.463342, 0.40247 , 0.397703, 0.40273 , 0.482648, 0.448319,
        0.492149, 0.466614, 0.493402, 0.5055  , 0.508467, 0.467371, 0.472328,
        0.372298, 0.421053, 0.42373 , 0.432353, 0.434132, 0.560845, 0.484528,
        0.476754, 0.524846, 0.402134, 0.529292, 0.405095, 0.419344, 0.407585,
        0.444751, 0.421279, 0.472121, 0.488612, 0.476568, 0.486289, 0.480945,
        0.418345, 0.409271, 0.431971, 0.404848, 0.441753, 0.430352, 0.457017,
        0.44467 , 0.508416, 0.483539, 0.512877, 0.575599, 0.405972, 0.411241,
        0.362924, 0.413193, 0.396715, 0.410564, 0.57781 , 0.526472, 0.497957,
        0.493168]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>country_prior_mean</span></div><div class='xr-var-dims'>(country, time)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-e8f304d2-27e7-4a4f-9438-7f4a7418b397' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e8f304d2-27e7-4a4f-9438-7f4a7418b397' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0be0acdc-5919-4592-818a-623f2e830d82' class='xr-var-data-in' type='checkbox'><label for='data-0be0acdc-5919-4592-818a-623f2e830d82' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>Tg/yr</dd><dt><span>long_name :</span></dt><dd>Prior emissions from individual countries</dd></dl></div><div class='xr-var-data'><pre>array([[2.061157, 2.061157, 2.061157, 2.061157, 2.061157, 2.061157, 2.061157,
        2.061157, 2.061157, 2.061157, 2.061157, 2.061157, 2.006323, 2.006323,
        2.006323, 2.006323, 2.006323, 2.006323, 2.006323, 2.006323, 2.006323,
        2.006323, 2.006323, 2.006323, 1.969883, 1.969883, 1.969883, 1.969883,
        1.969883, 1.969883, 1.969883, 1.969883, 1.969883, 1.969883, 1.969883,
        1.969883, 1.97125 , 1.97125 , 1.97125 , 1.97125 , 1.97125 , 1.97125 ,
        1.97125 , 1.97125 , 1.97125 , 1.97125 , 1.97125 , 1.97125 , 1.96389 ,
        1.96389 , 1.96389 , 1.96389 , 1.96389 , 1.96389 , 1.96389 , 1.96389 ,
        1.96389 , 1.96389 , 1.96389 , 1.96389 , 1.997247, 1.997247, 1.997247,
        1.997247, 1.997247, 1.997247, 1.997247, 1.997247, 1.997247, 1.997247,
        1.997247, 1.997247, 1.986332, 1.986332, 1.986332, 1.986332, 1.986332,
        1.986332, 1.986332, 1.986332, 1.986332, 1.986332, 1.986332, 1.986332,
        1.986332, 1.986332, 1.986332, 1.986332, 1.986332, 1.986332, 1.986332,
        1.986332, 1.986332, 1.986332, 1.986332, 1.986332, 1.986332, 1.986332,
        1.986332, 1.986332, 1.986332, 1.986332, 1.986332, 1.986332, 1.986332,
        1.986332, 1.986332, 1.986332, 1.986332, 1.986332, 1.986332, 1.986332,
        1.986332, 1.986332, 1.986332, 1.986332, 1.986332, 1.986332, 1.986332,
        1.986332]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>country_prior_std</span></div><div class='xr-var-dims'>(country, time)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-69be56a8-d391-43d5-aeef-2ee247581246' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-69be56a8-d391-43d5-aeef-2ee247581246' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2fad136a-8ca2-4871-9d81-482dc5a24ec6' class='xr-var-data-in' type='checkbox'><label for='data-2fad136a-8ca2-4871-9d81-482dc5a24ec6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>Tg/yr</dd><dt><span>long_name :</span></dt><dd>Prior standard deviation of emissions from individual countries</dd></dl></div><div class='xr-var-data'><pre>array([[0.850945, 0.850945, 0.850945, 0.850945, 0.850945, 0.850945, 0.850945,
        0.850945, 0.850945, 0.850945, 0.850945, 0.850945, 0.812522, 0.812522,
        0.812522, 0.812522, 0.812522, 0.812522, 0.812522, 0.812522, 0.812522,
        0.812522, 0.812522, 0.812522, 0.791748, 0.791748, 0.791748, 0.791748,
        0.791748, 0.791748, 0.791748, 0.791748, 0.791748, 0.791748, 0.791748,
        0.791748, 0.791432, 0.791432, 0.791432, 0.791432, 0.791432, 0.791432,
        0.791432, 0.791432, 0.791432, 0.791432, 0.791432, 0.791432, 0.788688,
        0.788688, 0.788688, 0.788688, 0.788688, 0.788688, 0.788688, 0.788688,
        0.788688, 0.788688, 0.788688, 0.788688, 0.805012, 0.805012, 0.805012,
        0.805012, 0.805012, 0.805012, 0.805012, 0.805012, 0.805012, 0.805012,
        0.805012, 0.805012, 0.804887, 0.804887, 0.804887, 0.804887, 0.804887,
        0.804887, 0.804887, 0.804887, 0.804887, 0.804887, 0.804887, 0.804887,
        0.804887, 0.804887, 0.804887, 0.804887, 0.804887, 0.804887, 0.804887,
        0.804887, 0.804887, 0.804887, 0.804887, 0.804887, 0.804887, 0.804887,
        0.804887, 0.804887, 0.804887, 0.804887, 0.804887, 0.804887, 0.804887,
        0.804887, 0.804887, 0.804887, 0.804887, 0.804887, 0.804887, 0.804887,
        0.804887, 0.804887, 0.804887, 0.804887, 0.804887, 0.804887, 0.804887,
        0.804887]], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-1cfc20ad-c190-4aa8-92a3-98305ddbcc16' class='xr-section-summary-in' type='checkbox'  checked><label for='section-1cfc20ad-c190-4aa8-92a3-98305ddbcc16' class='xr-section-summary' >Attributes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>history :</span></dt><dd>Created on 2022-12-06 08:38:46 by A. J. Manning</dd><dt><span>molecular_weight :</span></dt><dd>16.0</dd></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">50.041</span><span class="p">,</span> <span class="mf">61.975002</span><span class="p">,</span> <span class="mf">0.234</span><span class="p">)</span>
<span class="n">lon</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mf">11.66</span><span class="p">,</span> <span class="mf">1.716001</span><span class="p">,</span> <span class="mf">0.352</span><span class="p">)</span>
<span class="n">area</span> <span class="o">=</span> <span class="n">areagrid</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">)</span>
<span class="c1">#area</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Create a function to produce a mean flux reading for each year;</span>

<span class="k">def</span> <span class="nf">weighted_temporal_mean</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">var</span><span class="p">):</span>

    <span class="n">month_length</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">days_in_month</span>

    <span class="c1"># Calculate the weights</span>
    <span class="n">wgts</span> <span class="o">=</span> <span class="n">month_length</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;time.year&quot;</span><span class="p">)</span> <span class="o">/</span> <span class="n">month_length</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;time.year&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

    <span class="c1"># Make sure the weights in each year add up to 1</span>
    <span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_allclose</span><span class="p">(</span><span class="n">wgts</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;time.year&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">xr</span><span class="o">.</span><span class="n">ALL_DIMS</span><span class="p">),</span> <span class="mf">1.0</span><span class="p">)</span>

    <span class="c1"># Subset our dataset for our variable</span>
    <span class="n">obs</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="n">var</span><span class="p">]</span>

    <span class="c1"># Setup our masking for nan values</span>
    <span class="n">cond</span> <span class="o">=</span> <span class="n">obs</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span>
    <span class="n">ones</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">cond</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>

    <span class="c1"># Calculate the numerator</span>
    <span class="n">obs_sum</span> <span class="o">=</span> <span class="p">(</span><span class="n">obs</span> <span class="o">*</span> <span class="n">wgts</span><span class="p">)</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s2">&quot;AS&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>

    <span class="c1"># Calculate the denominator</span>
    <span class="n">ones_out</span> <span class="o">=</span> <span class="p">(</span><span class="n">ones</span> <span class="o">*</span> <span class="n">wgts</span><span class="p">)</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s2">&quot;AS&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">obs_sum</span> <span class="o">/</span> <span class="n">ones_out</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Intem_new_year</span> <span class="o">=</span> <span class="n">weighted_temporal_mean</span><span class="p">(</span><span class="n">ds_flux</span><span class="p">,</span> <span class="s2">&quot;flux_prior&quot;</span><span class="p">)</span>
<span class="n">Intem2012</span> <span class="o">=</span> <span class="n">Intem_new_year</span><span class="p">[</span><span class="nb">dict</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">0</span><span class="p">)]</span> <span class="o">*</span> <span class="n">area</span>
<span class="n">Intem2013</span> <span class="o">=</span> <span class="n">Intem_new_year</span><span class="p">[</span><span class="nb">dict</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">1</span><span class="p">)]</span> <span class="o">*</span> <span class="n">area</span>
<span class="n">Intem2014</span> <span class="o">=</span> <span class="n">Intem_new_year</span><span class="p">[</span><span class="nb">dict</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">2</span><span class="p">)]</span> <span class="o">*</span> <span class="n">area</span>
<span class="n">Intem2015</span> <span class="o">=</span> <span class="n">Intem_new_year</span><span class="p">[</span><span class="nb">dict</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">3</span><span class="p">)]</span> <span class="o">*</span> <span class="n">area</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Intem2013</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh at 0x7fc1f8324040&gt;
</pre></div>
</div>
<img alt="_images/Methodology_8_1.png" src="_images/Methodology_8_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">read_invent_ch4_old</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">species</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
    <span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">takewhile</span>
    <span class="kn">import</span> <span class="nn">plotly.graph_objects</span> <span class="k">as</span> <span class="nn">go</span>
    <span class="kn">import</span> <span class="nn">base64</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
    <span class="kn">import</span> <span class="nn">glob</span>
    <span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
    
    <span class="n">csv</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;data/ch4-ukghg-</span><span class="si">{</span><span class="n">species</span><span class="si">}</span><span class="s2">_EUROPE_</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">.nc&quot;</span><span class="p">)</span>
    
    <span class="n">flux</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">csv</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    
    <span class="n">min_lon</span> <span class="o">=</span> <span class="o">-</span><span class="mi">12</span>
    <span class="n">min_lat</span> <span class="o">=</span> <span class="mi">48</span>
    <span class="n">max_lon</span> <span class="o">=</span> <span class="mi">5</span> 
    <span class="n">max_lat</span> <span class="o">=</span> <span class="mi">62</span> 
    
    <span class="n">cropped_ds</span> <span class="o">=</span> <span class="n">flux</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">min_lat</span><span class="p">,</span><span class="n">max_lat</span><span class="p">),</span> <span class="n">lon</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">min_lon</span><span class="p">,</span><span class="n">max_lon</span><span class="p">))</span>
    
    <span class="n">cropped_ds</span> <span class="o">=</span> <span class="n">cropped_ds</span> <span class="o">*</span> <span class="n">area</span>
    
    <span class="k">return</span> <span class="n">cropped_ds</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">read_invent_ch4</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">species</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
    <span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">takewhile</span>
    <span class="kn">import</span> <span class="nn">plotly.graph_objects</span> <span class="k">as</span> <span class="nn">go</span>
    <span class="kn">import</span> <span class="nn">base64</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
    <span class="kn">import</span> <span class="nn">glob</span>
    <span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
    
    <span class="n">csv</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;data/ch4-edgarv7-ukghg-yearly/ch4-edgarv7-ukghg-europe-</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">/ch4-edgarv7-ukghg-</span><span class="si">{</span><span class="n">species</span><span class="si">}</span><span class="s2">_EUROPE_</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">.nc&quot;</span><span class="p">)</span>
    
    <span class="n">flux</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">csv</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    
    <span class="n">min_lon</span> <span class="o">=</span> <span class="o">-</span><span class="mi">12</span>
    <span class="n">min_lat</span> <span class="o">=</span> <span class="mi">50</span>

    <span class="n">max_lon</span> <span class="o">=</span> <span class="mi">2</span> 
    <span class="n">max_lat</span> <span class="o">=</span> <span class="mi">62</span> 
    
    <span class="n">cropped_ds</span> <span class="o">=</span> <span class="n">flux</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">min_lat</span><span class="p">,</span><span class="n">max_lat</span><span class="p">),</span> <span class="n">lon</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">min_lon</span><span class="p">,</span><span class="n">max_lon</span><span class="p">))</span>
    
    <span class="n">cropped_ds1</span> <span class="o">=</span> <span class="n">cropped_ds</span><span class="p">[</span><span class="nb">dict</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">0</span><span class="p">)]</span> <span class="o">*</span> <span class="n">area</span>
        
    <span class="k">return</span> <span class="n">cropped_ds1</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test2012</span> <span class="o">=</span> <span class="n">read_invent_ch4</span><span class="p">(</span><span class="s2">&quot;2012&quot;</span><span class="p">,</span> <span class="s2">&quot;total&quot;</span><span class="p">)</span>
<span class="n">test2012</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:  (lat: 52, lon: 39)
Coordinates:
  * lat      (lat) float32 50.04 50.28 50.51 50.74 ... 61.27 61.51 61.74 61.97
  * lon      (lon) float32 -11.66 -11.31 -10.96 -10.6 ... 0.66 1.012 1.364 1.716
    time     datetime64[ns] 2012-01-01
Data variables:
    flux     (lat, lon) float64 0.002021 0.002142 ... 0.0006935 0.0005155
Attributes:
    Processed by:   wz22079@bristol.ac.uk
    Processed on:   2022-12-08 14:59:17.769336+00:00
    title:          EDGAR with UK lat/lons replaced with UKGHG values, regrid...
    EDGAR sectors:  [&#x27;AGS&#x27;, &#x27;AWB&#x27;, &#x27;ENF&#x27;, &#x27;MNM&#x27;, &#x27;RCO&#x27;, &#x27;ENE&#x27;, &#x27;IND&#x27;, &#x27;CHE&#x27;, ...
    UKGHG sectors:  total</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-e8591f7a-b605-4ce3-a4d8-42808504bf20' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-e8591f7a-b605-4ce3-a4d8-42808504bf20' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>lat</span>: 52</li><li><span class='xr-has-index'>lon</span>: 39</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-36742ecd-52c9-448b-98d3-564d86516fe2' class='xr-section-summary-in' type='checkbox'  checked><label for='section-36742ecd-52c9-448b-98d3-564d86516fe2' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>50.04 50.28 50.51 ... 61.74 61.97</div><input id='attrs-6449a20b-f184-4b65-83ec-2db37ad6f950' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-6449a20b-f184-4b65-83ec-2db37ad6f950' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-802b664f-b156-4595-bd12-fcbd3eeb88f0' class='xr-var-data-in' type='checkbox'><label for='data-802b664f-b156-4595-bd12-fcbd3eeb88f0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([50.041, 50.275, 50.509, 50.743, 50.977, 51.211, 51.445, 51.679, 51.913,
       52.147, 52.381, 52.615, 52.849, 53.083, 53.317, 53.551, 53.785, 54.019,
       54.253, 54.487, 54.721, 54.955, 55.189, 55.423, 55.657, 55.891, 56.125,
       56.359, 56.593, 56.827, 57.061, 57.295, 57.529, 57.763, 57.997, 58.231,
       58.465, 58.699, 58.933, 59.167, 59.401, 59.635, 59.869, 60.103, 60.337,
       60.571, 60.805, 61.039, 61.273, 61.507, 61.741, 61.975], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-11.66 -11.31 ... 1.364 1.716</div><input id='attrs-0dcd2fe9-a582-4db4-b76a-32cf9b467f73' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-0dcd2fe9-a582-4db4-b76a-32cf9b467f73' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a3052325-8cb1-44cc-af8c-5a8985e6ab45' class='xr-var-data-in' type='checkbox'><label for='data-a3052325-8cb1-44cc-af8c-5a8985e6ab45' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-11.659997, -11.307997, -10.955997, -10.603997, -10.251997,  -9.899997,
        -9.547997,  -9.195997,  -8.843997,  -8.491997,  -8.139997,  -7.787997,
        -7.435997,  -7.083997,  -6.731997,  -6.379997,  -6.027997,  -5.675997,
        -5.323997,  -4.971997,  -4.619997,  -4.267997,  -3.915997,  -3.563997,
        -3.211997,  -2.859997,  -2.507997,  -2.155997,  -1.803997,  -1.451997,
        -1.099997,  -0.747997,  -0.395997,  -0.043997,   0.308003,   0.660003,
         1.012003,   1.364003,   1.716003], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>time</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2012-01-01</div><input id='attrs-1280fbb1-17c8-4447-a4ee-964f1c7e04da' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-1280fbb1-17c8-4447-a4ee-964f1c7e04da' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-47ccb19c-539f-48ec-bfd0-ee7e9d65cf3e' class='xr-var-data-in' type='checkbox'><label for='data-47ccb19c-539f-48ec-bfd0-ee7e9d65cf3e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(&#x27;2012-01-01T00:00:00.000000000&#x27;, dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-710878ad-0e47-405f-a0f5-256077f87766' class='xr-section-summary-in' type='checkbox'  checked><label for='section-710878ad-0e47-405f-a0f5-256077f87766' class='xr-section-summary' >Data variables: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>flux</span></div><div class='xr-var-dims'>(lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.002021 0.002142 ... 0.0005155</div><input id='attrs-385729aa-ad0f-45a6-b6a5-d4e1b0ba5cc0' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-385729aa-ad0f-45a6-b6a5-d4e1b0ba5cc0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1d38cdb7-b860-4274-a72d-ad4bebdf29c1' class='xr-var-data-in' type='checkbox'><label for='data-1d38cdb7-b860-4274-a72d-ad4bebdf29c1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[2.02108032e-03, 2.14159769e-03, 2.79322018e-03, ...,
        4.84322275e-06, 6.54082299e-06, 8.60947749e+00],
       [1.93391551e-03, 1.84134265e-03, 2.17896162e-03, ...,
        6.89517189e-07, 9.63617968e-07, 6.92603595e+00],
       [1.76365565e-03, 1.89504917e-03, 2.21774627e-03, ...,
        1.14686312e-03, 5.16846487e-05, 1.05510929e+01],
       ...,
       [1.57505937e-04, 9.26961123e-05, 1.18221829e-04, ...,
        6.26783019e-06, 4.50850362e-02, 2.10572352e-06],
       [1.35752963e-04, 1.55726020e-04, 1.33880982e-04, ...,
        1.19933631e-06, 1.10235550e-02, 5.39203174e-07],
       [8.54465585e-05, 1.18631670e-04, 1.28924488e-04, ...,
        5.75625648e-04, 6.93504491e-04, 5.15472054e-04]])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-d5305691-791f-4702-b621-008e71141bfe' class='xr-section-summary-in' type='checkbox'  checked><label for='section-d5305691-791f-4702-b621-008e71141bfe' class='xr-section-summary' >Attributes: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>Processed by :</span></dt><dd>wz22079@bristol.ac.uk</dd><dt><span>Processed on :</span></dt><dd>2022-12-08 14:59:17.769336+00:00</dd><dt><span>title :</span></dt><dd>EDGAR with UK lat/lons replaced with UKGHG values, regridded to EUROPE domain</dd><dt><span>EDGAR sectors :</span></dt><dd>[&#x27;AGS&#x27;, &#x27;AWB&#x27;, &#x27;ENF&#x27;, &#x27;MNM&#x27;, &#x27;RCO&#x27;, &#x27;ENE&#x27;, &#x27;IND&#x27;, &#x27;CHE&#x27;, &#x27;IRO&#x27;, &#x27;REF_TRF&#x27;, &#x27;PRO&#x27;, &#x27;TNR_Aviation_CDS&#x27;, &#x27;TNR_Aviation_CRS&#x27;, &#x27;TNR_Aviation_LTO&#x27;, &#x27;TNR_Other&#x27;, &#x27;TNR_Ship&#x27;, &#x27;TRO_noRES&#x27;, &#x27;SWD_INC&#x27;, &#x27;SWD_LDF&#x27;, &#x27;WWT&#x27;]</dd><dt><span>UKGHG sectors :</span></dt><dd>total</dd></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_sector</span><span class="p">(</span><span class="n">year</span><span class="p">):</span>
    
    <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span><span class="n">cartopy</span><span class="o">.</span><span class="n">crs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()})</span>
    
    <span class="n">species</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;total&quot;</span><span class="p">,</span> <span class="s2">&quot;agric&quot;</span><span class="p">,</span> <span class="s2">&quot;domcom&quot;</span><span class="p">,</span> <span class="s2">&quot;energyprod&quot;</span><span class="p">,</span> <span class="s2">&quot;indcom&quot;</span><span class="p">,</span> <span class="s2">&quot;indproc&quot;</span><span class="p">,</span> <span class="s2">&quot;offshore&quot;</span><span class="p">,</span> <span class="s2">&quot;othertrans&quot;</span><span class="p">,</span> <span class="s2">&quot;roadtrans&quot;</span><span class="p">,</span> <span class="s2">&quot;waste&quot;</span><span class="p">]</span>
    
    <span class="n">fontsizes</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;title&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;labels&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;axis&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">}</span>
    
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">species</span><span class="p">,</span> <span class="n">axs</span><span class="o">.</span><span class="n">flatten</span><span class="p">()):</span>
        
        <span class="n">a</span> <span class="o">=</span> <span class="n">read_invent_ch4</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">read_invent_ch4</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="s2">&quot;total&quot;</span><span class="p">)</span>
        
        <span class="n">fract</span> <span class="o">=</span> <span class="mi">100</span><span class="o">*</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">flux</span> <span class="o">/</span> <span class="n">b</span><span class="o">.</span><span class="n">flux</span><span class="p">)</span>
    
        <span class="n">fract</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">fract</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
        
        <span class="n">test</span> <span class="o">=</span> <span class="n">fract</span><span class="o">.</span><span class="n">reindex_like</span><span class="p">(</span><span class="n">Intem2012</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">year</span> <span class="o">==</span> <span class="s2">&quot;2012&quot;</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">test</span><span class="o">/</span><span class="mi">100</span> <span class="o">*</span> <span class="n">Intem2012</span>
            <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;Reds&#39;</span>
        <span class="k">elif</span> <span class="n">year</span> <span class="o">==</span> <span class="s2">&quot;2013&quot;</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">test</span><span class="o">/</span><span class="mi">100</span> <span class="o">*</span> <span class="n">Intem2013</span>
            <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;Blues&#39;</span>
        <span class="k">elif</span> <span class="n">year</span> <span class="o">==</span> <span class="s2">&quot;2014&quot;</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">test</span><span class="o">/</span><span class="mi">100</span> <span class="o">*</span> <span class="n">Intem2014</span>
            <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;Greens&#39;</span>
        <span class="k">elif</span> <span class="n">year</span> <span class="o">==</span> <span class="s2">&quot;2015&quot;</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">test</span><span class="o">/</span><span class="mi">100</span> <span class="o">*</span> <span class="n">Intem2015</span>
            <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;Purples&#39;</span>
                
        <span class="n">a</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">lon</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="o">-</span><span class="mi">12</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="mf">49.9</span><span class="p">,</span><span class="mi">60</span><span class="p">],</span> <span class="n">crs</span><span class="o">=</span><span class="n">cartopy</span><span class="o">.</span><span class="n">crs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>        
        <span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="n">resolution</span><span class="o">=</span><span class="s1">&#39;50m&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="o">-</span><span class="mi">12</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">crs</span><span class="o">=</span><span class="n">cartopy</span><span class="o">.</span><span class="n">crs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
        <span class="n">lon_formatter</span> <span class="o">=</span> <span class="n">LongitudeFormatter</span><span class="p">(</span><span class="n">number_format</span><span class="o">=</span><span class="s1">&#39;.1f&#39;</span><span class="p">,</span>
                                    <span class="n">degree_symbol</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
                                    <span class="n">dateline_direction_label</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">lon_formatter</span><span class="p">)</span>        
        <span class="c1"># set y-ticks for the plot, and format          </span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="mi">50</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">58</span><span class="p">],</span> <span class="n">crs</span><span class="o">=</span><span class="n">cartopy</span><span class="o">.</span><span class="n">crs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
        <span class="n">lat_formatter</span> <span class="o">=</span> <span class="n">LatitudeFormatter</span><span class="p">(</span><span class="n">number_format</span><span class="o">=</span><span class="s1">&#39;.1f&#39;</span><span class="p">,</span>  <span class="n">degree_symbol</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">lat_formatter</span><span class="p">)</span>             
        <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="n">fontsizes</span><span class="p">[</span><span class="s2">&quot;axis&quot;</span><span class="p">])</span> 
        
        <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
        
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;2013&quot;</span> <span class="o">+</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">+</span> <span class="n">name</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="n">fontsizes</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Latitude (degrees)&quot;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="n">fontsizes</span><span class="p">[</span><span class="s2">&quot;labels&quot;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Longitude (degrees)&quot;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="n">fontsizes</span><span class="p">[</span><span class="s2">&quot;labels&quot;</span><span class="p">])</span>
        
    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_sector</span><span class="p">(</span><span class="s2">&quot;2013&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Methodology_13_0.png" src="_images/Methodology_13_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_sector_perc</span><span class="p">(</span><span class="n">year</span><span class="p">):</span>
    
    <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span><span class="n">cartopy</span><span class="o">.</span><span class="n">crs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()})</span>
    
    <span class="n">species</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;total&quot;</span><span class="p">,</span> <span class="s2">&quot;agric&quot;</span><span class="p">,</span> <span class="s2">&quot;domcom&quot;</span><span class="p">,</span> <span class="s2">&quot;energyprod&quot;</span><span class="p">,</span> <span class="s2">&quot;indcom&quot;</span><span class="p">,</span> <span class="s2">&quot;indproc&quot;</span><span class="p">,</span> <span class="s2">&quot;offshore&quot;</span><span class="p">,</span> <span class="s2">&quot;othertrans&quot;</span><span class="p">,</span> <span class="s2">&quot;roadtrans&quot;</span><span class="p">,</span> <span class="s2">&quot;waste&quot;</span><span class="p">]</span>
    
    <span class="n">fontsizes</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;title&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;labels&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;axis&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">}</span>
    
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">species</span><span class="p">,</span> <span class="n">axs</span><span class="o">.</span><span class="n">flatten</span><span class="p">()):</span>
        
        <span class="n">a</span> <span class="o">=</span> <span class="n">read_invent_ch4</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">read_invent_ch4</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="s2">&quot;total&quot;</span><span class="p">)</span>
        

        <span class="n">fract</span> <span class="o">=</span> <span class="mi">100</span><span class="o">*</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">flux</span> <span class="o">/</span> <span class="n">b</span><span class="o">.</span><span class="n">flux</span><span class="p">)</span>

        <span class="n">fract</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">fract</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

        <span class="n">test</span> <span class="o">=</span> <span class="n">fract</span><span class="o">.</span><span class="n">reindex_like</span><span class="p">(</span><span class="n">Intem2012</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">year</span> <span class="o">==</span> <span class="s2">&quot;2012&quot;</span><span class="p">:</span>
            <span class="n">test1</span> <span class="o">=</span> <span class="n">test</span> <span class="o">*</span> <span class="n">Intem2012</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">test1</span> <span class="o">/</span> <span class="n">Intem2012</span> <span class="c1">#* 100</span>
            <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;Reds&#39;</span>
        <span class="k">elif</span> <span class="n">year</span> <span class="o">==</span> <span class="s2">&quot;2013&quot;</span><span class="p">:</span>
            <span class="n">test1</span> <span class="o">=</span> <span class="n">test</span> <span class="o">*</span> <span class="n">Intem2013</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">test1</span> <span class="o">/</span> <span class="n">Intem2013</span> <span class="c1">#* 100</span>
            <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;Blues&#39;</span>
        <span class="k">elif</span> <span class="n">year</span> <span class="o">==</span> <span class="s2">&quot;2014&quot;</span><span class="p">:</span>
            <span class="n">test1</span> <span class="o">=</span> <span class="n">test</span> <span class="o">*</span> <span class="n">Intem2014</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">test1</span> <span class="o">/</span> <span class="n">Intem2014</span> <span class="c1">#* 100</span>
            <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;Greens&#39;</span>
        <span class="k">elif</span> <span class="n">year</span> <span class="o">==</span> <span class="s2">&quot;2015&quot;</span><span class="p">:</span>
            <span class="n">test1</span> <span class="o">=</span> <span class="n">test</span> <span class="o">*</span> <span class="n">Intem2015</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">test1</span> <span class="o">/</span> <span class="n">Intem2015</span> <span class="c1">#* 100</span>
            <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;Purples&#39;</span>
                
        <span class="n">a</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">lon</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="o">-</span><span class="mi">12</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="mf">49.9</span><span class="p">,</span><span class="mi">60</span><span class="p">],</span> <span class="n">crs</span><span class="o">=</span><span class="n">cartopy</span><span class="o">.</span><span class="n">crs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>        
        <span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="n">resolution</span><span class="o">=</span><span class="s1">&#39;50m&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="o">-</span><span class="mi">12</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">crs</span><span class="o">=</span><span class="n">cartopy</span><span class="o">.</span><span class="n">crs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
        <span class="n">lon_formatter</span> <span class="o">=</span> <span class="n">LongitudeFormatter</span><span class="p">(</span><span class="n">number_format</span><span class="o">=</span><span class="s1">&#39;.1f&#39;</span><span class="p">,</span>
                                    <span class="n">degree_symbol</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
                                    <span class="n">dateline_direction_label</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">lon_formatter</span><span class="p">)</span>        
        <span class="c1"># set y-ticks for the plot, and format          </span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="mi">50</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">58</span><span class="p">],</span> <span class="n">crs</span><span class="o">=</span><span class="n">cartopy</span><span class="o">.</span><span class="n">crs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
        <span class="n">lat_formatter</span> <span class="o">=</span> <span class="n">LatitudeFormatter</span><span class="p">(</span><span class="n">number_format</span><span class="o">=</span><span class="s1">&#39;.1f&#39;</span><span class="p">,</span>  <span class="n">degree_symbol</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">lat_formatter</span><span class="p">)</span>             
        <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="n">fontsizes</span><span class="p">[</span><span class="s2">&quot;axis&quot;</span><span class="p">])</span> 
    
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">year</span> <span class="o">+</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">+</span> <span class="n">name</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="n">fontsizes</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">])</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Latitude (degrees)&quot;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="n">fontsizes</span><span class="p">[</span><span class="s2">&quot;labels&quot;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Longitude (degrees)&quot;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="n">fontsizes</span><span class="p">[</span><span class="s2">&quot;labels&quot;</span><span class="p">])</span>
        
    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_sector_perc</span><span class="p">(</span><span class="s2">&quot;2013&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Methodology_15_0.png" src="_images/Methodology_15_0.png" />
</div>
</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="Main_Page1.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Annual emissions broken down by sector</p>
        </div>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By The University of Bristol<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>